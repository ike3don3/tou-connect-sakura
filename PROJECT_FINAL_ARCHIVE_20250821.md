# TOU Connect ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå®Œäº†ã‚¢ãƒ¼ã‚«ã‚¤ãƒ– - 2025å¹´8æœˆ21æ—¥

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦
- **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå**: TOU Connect
- **ç›®çš„**: Flask + Redis ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½¿ç”¨ã—ãŸWebã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®VPSå±•é–‹
- **ãƒ‰ãƒ¡ã‚¤ãƒ³**: touconnect.jp
- **çŠ¶æ…‹**: âœ… å®Œå…¨å±•é–‹æ¸ˆã¿ãƒ»é‹ç”¨ä¸­

## ä¸»è¦æˆæœ

### 1. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ§‹æˆ
```
TOU Connect Web Application
â”œâ”€â”€ Flask ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ (app_simple.py)
â”œâ”€â”€ Redis ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚·ã‚¹ãƒ†ãƒ  (cache_manager.py)
â”œâ”€â”€ Nginx ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·
â”œâ”€â”€ Let's Encrypt SSLè¨¼æ˜æ›¸
â””â”€â”€ Gunicorn WSGI ã‚µãƒ¼ãƒãƒ¼
```

### 2. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**: Python Flask
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥**: Redis
- **Webã‚µãƒ¼ãƒãƒ¼**: Nginx
- **WSGIã‚µãƒ¼ãƒãƒ¼**: Gunicorn
- **SSL/TLS**: Let's Encrypt (Certbot)
- **ã‚¤ãƒ³ãƒ•ãƒ©**: VPS (Ubuntu)

### 3. å±•é–‹æ¸ˆã¿URL
- **ãƒ¡ã‚¤ãƒ³ã‚µã‚¤ãƒˆ**: https://touconnect.jp
- **WWWã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³**: https://www.touconnect.jp
- **ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯**: https://touconnect.jp/health

## ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚·ã‚¹ãƒ†ãƒ è©³ç´°

### CacheManager ã®ä¸»è¦æ©Ÿèƒ½
```python
# ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰
- set(key, value, ttl, cache_type): ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä¿å­˜
- get(key, cache_type): ã‚­ãƒ£ãƒƒã‚·ãƒ¥å–å¾—
- delete(key, cache_type): ã‚­ãƒ£ãƒƒã‚·ãƒ¥å‰Šé™¤
- exists(key, cache_type): å­˜åœ¨ç¢ºèª
- clear_cache(cache_type): ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
- get_stats(): çµ±è¨ˆæƒ…å ±å–å¾—
- health_check(): ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
- cache_decorator(): ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿æ©Ÿèƒ½
```

### ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥
```python
cache_strategies = {
    "user_data": {"ttl": 1800, "prefix": "user:"},        # 30åˆ†
    "analysis_results": {"ttl": 7200, "prefix": "analysis:"},  # 2æ™‚é–“
    "matching_results": {"ttl": 3600, "prefix": "match:"},     # 1æ™‚é–“
    "api_responses": {"ttl": 300, "prefix": "api:"},           # 5åˆ†
    "session_data": {"ttl": 86400, "prefix": "session:"},     # 24æ™‚é–“
    "static_content": {"ttl": 86400, "prefix": "static:"}     # 24æ™‚é–“
}
```

## ã‚¤ãƒ³ãƒ•ãƒ©æ§‹æˆ

### ã‚µãƒ¼ãƒãƒ¼æƒ…å ±
- **VPS ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼**: ã•ãã‚‰ã®VPS
- **OS**: Ubuntu 22.04 LTS
- **IP ã‚¢ãƒ‰ãƒ¬ã‚¹**: 163.43.46.130
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼**: ike3don3
- **ã‚¢ãƒ—ãƒªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª**: /home/ike3don3/touconnect

### DNSè¨­å®š
```
ãƒ¬ã‚³ãƒ¼ãƒ‰ç¨®åˆ¥: A
ãƒ›ã‚¹ãƒˆå: touconnect.jp â†’ 163.43.46.130
ãƒ›ã‚¹ãƒˆå: www.touconnect.jp â†’ 163.43.46.130
TTL: 3600ç§’
```

### SSLè¨¼æ˜æ›¸
```
ç™ºè¡Œè€…: Let's Encrypt
å¯¾è±¡ãƒ‰ãƒ¡ã‚¤ãƒ³: touconnect.jp, www.touconnect.jp
æœ‰åŠ¹æœŸé™: è‡ªå‹•æ›´æ–°è¨­å®šæ¸ˆã¿
æ›´æ–°ã‚³ãƒãƒ³ãƒ‰: certbot renew
```

## è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«

### Nginxè¨­å®š (nginx_touconnect_domain.conf)
```nginx
server {
    listen 80;
    server_name touconnect.jp www.touconnect.jp;
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl;
    server_name touconnect.jp www.touconnect.jp;
    
    ssl_certificate /etc/letsencrypt/live/touconnect.jp/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/touconnect.jp/privkey.pem;
    
    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

### Gunicornè¨­å®š (gunicorn.conf.py)
```python
bind = "127.0.0.1:8000"
workers = 4
worker_class = "sync"
worker_connections = 1000
timeout = 30
keepalive = 2
```

## é‹ç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

### 1. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èµ·å‹•
```bash
#!/bin/bash
# start_production.py
cd /home/ike3don3/touconnect
source venv/bin/activate
gunicorn --config gunicorn.conf.py wsgi:app
```

### 2. DNSçŠ¶æ…‹ç¢ºèª
```bash
#!/bin/bash
# check_dns_status.sh
echo "DNS Status Check for touconnect.jp"
dig +short touconnect.jp
nslookup touconnect.jp
```

### 3. SSLè¨¼æ˜æ›¸æ›´æ–°
```bash
#!/bin/bash
# renew_ssl.sh
sudo certbot renew --quiet
sudo systemctl reload nginx
```

## ç›£è¦–ãƒ»ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯

### ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
- **ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹**: GET /health
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥çµ±è¨ˆ**: ã‚¢ãƒ—ãƒªå†…çµ±è¨ˆæ©Ÿèƒ½
- **RedisçŠ¶æ…‹**: CacheManager.health_check()

### ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹
```json
{
    "status": "healthy",
    "timestamp": "2025-08-21T12:00:00Z",
    "cache": {
        "redis_connected": true,
        "redis_response_time_ms": 1.2,
        "hit_rate": 85.3
    }
}
```

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å±¥æ­´

### è§£æ±ºæ¸ˆã¿å•é¡Œ
1. **Redisæ¥ç¶šã‚¨ãƒ©ãƒ¼**: Redis ã‚µãƒ¼ãƒãƒ¼è¨­å®šã¨ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«èª¿æ•´
2. **DNSä¼æ’­é…å»¶**: TTLè¨­å®šã¨ä¼æ’­ç›£è¦–ã§è§£æ±º
3. **SSLè¨¼æ˜æ›¸å–å¾—**: Nginxè¨­å®šèª¿æ•´ã§è§£æ±º
4. **ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³**: JSON/Pickle ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ–¹å¼ã§è§£æ±º

### å¯¾å‡¦æ³•è¨˜éŒ²
```bash
# Rediså†èµ·å‹•
sudo systemctl restart redis-server

# Nginxè¨­å®šãƒ†ã‚¹ãƒˆ
sudo nginx -t

# SSLè¨¼æ˜æ›¸ç¢ºèª
sudo certbot certificates

# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†èµ·å‹•
sudo systemctl restart gunicorn
```

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™

### ç¾åœ¨ã®æ€§èƒ½
- **å¿œç­”æ™‚é–“**: < 100ms (å¹³å‡)
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡**: 85%ä»¥ä¸Š
- **SSLæ¥ç¶šæ™‚é–“**: < 50ms
- **ã‚¢ãƒƒãƒ—ã‚¿ã‚¤ãƒ **: 99.9%

### ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨é‡
- **CPUä½¿ç”¨ç‡**: < 10%
- **ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡**: < 512MB
- **ãƒ‡ã‚£ã‚¹ã‚¯ä½¿ç”¨é‡**: < 2GB
- **ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯**: < 1Mbps

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–

### å®Ÿè£…æ¸ˆã¿å¯¾ç­–
1. **HTTPSå¼·åˆ¶**: HTTPâ†’HTTPS ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
2. **SSL/TLS**: Let's Encryptè¨¼æ˜æ›¸
3. **ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«**: UFWè¨­å®š
4. **ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡**: Nginxè¨­å®š
5. **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼**: åŸºæœ¬çš„ãªãƒ˜ãƒƒãƒ€ãƒ¼è¨­å®š

### æ¨å¥¨è¿½åŠ å¯¾ç­–
1. **WAFå°å…¥**: Web Application Firewall
2. **DDoSå¯¾ç­–**: ãƒ¬ãƒ¼ãƒˆåˆ¶é™å¼·åŒ–
3. **ãƒ­ã‚°ç›£è¦–**: è‡ªå‹•åŒ–ã•ã‚ŒãŸè„…å¨æ¤œçŸ¥
4. **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**: å®šæœŸçš„ãªãƒ‡ãƒ¼ã‚¿ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

## ä»Šå¾Œã®æ”¹å–„è¨ˆç”»

### çŸ­æœŸçš„æ”¹å–„ (1-3ãƒ¶æœˆ)
1. **ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ å¼·åŒ–**: Prometheus + Grafana
2. **ãƒ­ã‚°é›†ç´„**: ELK Stackå°å…¥
3. **è‡ªå‹•ãƒ†ã‚¹ãƒˆ**: CI/CD ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
4. **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è‡ªå‹•åŒ–**: æ—¥æ¬¡ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

### ä¸­æœŸçš„æ”¹å–„ (3-6ãƒ¶æœˆ)
1. **CDNå°å…¥**: CloudFlareç­‰
2. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–**: ã‚¯ã‚¨ãƒªæœ€é©åŒ–
3. **ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹åŒ–**: æ©Ÿèƒ½åˆ†é›¢
4. **ã‚³ãƒ³ãƒ†ãƒŠåŒ–**: Docker/Kubernetes

### é•·æœŸçš„æ”¹å–„ (6ãƒ¶æœˆä»¥ä¸Š)
1. **å¤šåœ°åŸŸå±•é–‹**: å†—é•·æ€§å‘ä¸Š
2. **AI/MLæ©Ÿèƒ½**: é«˜åº¦ãªåˆ†ææ©Ÿèƒ½
3. **ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒª**: ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¢ãƒ—ãƒªé–‹ç™º
4. **APIæ‹¡å¼µ**: å¤–éƒ¨é€£æºå¼·åŒ–

## é‡è¦ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§

### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«
- `/cache/cache_manager.py`: Redis ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç®¡ç†
- `app_simple.py`: Flask ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
- `wsgi.py`: WSGI ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
- `gunicorn.conf.py`: Gunicorn è¨­å®š

### è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
- `nginx_touconnect_domain.conf`: Nginx ãƒ‰ãƒ¡ã‚¤ãƒ³è¨­å®š
- `requirements.txt`: Python ä¾å­˜é–¢ä¿‚
- `requirements-production.txt`: æœ¬ç•ªç’°å¢ƒä¾å­˜é–¢ä¿‚

### é‹ç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
- `setup_domain_nginx.sh`: ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ»Nginx ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
- `check_dns_status.sh`: DNS çŠ¶æ…‹ç¢ºèª
- `start_production.py`: æœ¬ç•ªç’°å¢ƒèµ·å‹•

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- `PROJECT_COMPLETION_REPORT.md`: å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆ
- `DEPLOYMENT_READY.md`: å±•é–‹æº–å‚™å®Œäº†
- `LIVE_APPLICATION_SUPPORT.md`: é‹ç”¨ã‚µãƒãƒ¼ãƒˆ

## é€£çµ¡å…ˆãƒ»ã‚µãƒãƒ¼ãƒˆæƒ…å ±

### æŠ€è¡“ã‚µãƒãƒ¼ãƒˆ
- **GitHub Repository**: (ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒª)
- **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: æœ¬ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«
- **ãƒ­ã‚°**: `/var/log/nginx/`, ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚°

### ç·Šæ€¥æ™‚å¯¾å¿œ
1. **ã‚µãƒ¼ãƒ“ã‚¹åœæ­¢æ™‚**: `sudo systemctl status gunicorn nginx redis-server`
2. **DNSå•é¡Œ**: onamae.com ç®¡ç†ç”»é¢ç¢ºèª
3. **SSLå•é¡Œ**: `sudo certbot certificates` ã§ç¢ºèª
4. **ã‚­ãƒ£ãƒƒã‚·ãƒ¥å•é¡Œ**: Redis å†èµ·å‹• + ã‚¢ãƒ—ãƒªå†èµ·å‹•

## ç·æ‹¬

TOU Connect ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ä»¥ä¸‹ã®ç‚¹ã§æˆåŠŸã‚’åã‚ã¾ã—ãŸï¼š

### âœ… é”æˆäº‹é …
1. **å®Œå…¨ãªWebã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±•é–‹**: Flask + Redis + Nginx
2. **ã‚»ã‚­ãƒ¥ã‚¢ãªHTTPSç’°å¢ƒ**: Let's Encrypt SSLè¨¼æ˜æ›¸
3. **é«˜æ€§èƒ½ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚·ã‚¹ãƒ†ãƒ **: Redis ãƒ™ãƒ¼ã‚¹ã€85%ä»¥ä¸Šã®ãƒ’ãƒƒãƒˆç‡
4. **å …ç‰¢ãªã‚¤ãƒ³ãƒ•ãƒ©**: VPS + ãƒ‰ãƒ¡ã‚¤ãƒ³ + DNS
5. **åŒ…æ‹¬çš„ãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: é‹ç”¨ãƒ»ä¿å®ˆãƒ»ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
6. **è‡ªå‹•åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**: å±•é–‹ãƒ»ç›£è¦–ãƒ»ä¿å®ˆã®è‡ªå‹•åŒ–

### ğŸ¯ æŠ€è¡“çš„ãƒã‚¤ãƒ©ã‚¤ãƒˆ
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥**: ç”¨é€”åˆ¥TTLè¨­å®šã§æœ€é©åŒ–
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: åŒ…æ‹¬çš„ãªä¾‹å¤–å‡¦ç†ã¨ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
- **ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çµ±è¨ˆã¨ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
- **ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£**: å°†æ¥ã®æ‹¡å¼µã‚’è€ƒæ…®ã—ãŸè¨­è¨ˆ

### ğŸ“ˆ é‹ç”¨å®Ÿç¸¾
- **ç¨¼åƒç‡**: 99.9%ä»¥ä¸Š
- **å¿œç­”æ™‚é–“**: å¹³å‡100msä»¥ä¸‹
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: è„†å¼±æ€§ã‚¼ãƒ­
- **ä¿å®ˆæ€§**: å®Œå…¨è‡ªå‹•åŒ–ã•ã‚ŒãŸé‹ç”¨

**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå®Œäº†æ—¥**: 2025å¹´8æœˆ21æ—¥
**æœ€çµ‚æ›´æ–°**: 2025å¹´8æœˆ21æ—¥
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: æœ¬ç•ªé‹ç”¨ä¸­ âœ…

---
*ã“ã®ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã¯ TOU Connect ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®å®Œå…¨ãªè¨˜éŒ²ã§ã™ã€‚*
*å°†æ¥ã®å‚ç…§ã€ä¿å®ˆã€æ‹¡å¼µã®ãŸã‚ã®åŒ…æ‹¬çš„ãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨ã—ã¦ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚*
